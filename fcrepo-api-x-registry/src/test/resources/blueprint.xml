<?xml version="1.0" encoding="UTF-8"?>
<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:cm="http://aries.apache.org/blueprint/xmlns/blueprint-cm/v1.1.0"
  xsi:schemaLocation="
       http://www.osgi.org/xmlns/blueprint/v1.0.0 https://osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd
       http://aries.apache.org/blueprint/xmlns/blueprint-cm/v1.1.0  
       http://camel.apache.org/schema/blueprint http://camel.apache.org/schema/blueprint/camel-blueprint.xsd">
  <!-- http://stackoverflow.com/questions/20340470/how-to-spring-ioc-and-httpclient-4-3-1-closeablehttpclient -->

  <cm:property-placeholder persistent-id="org.fcrepo.apix.poc.amherst"
    update-strategy="reload">
    <cm:default-properties>
      <cm:property name="socketTimeoutMs" value="1000" />
      <cm:property name="connectTimeoutMs" value="1000" />
    </cm:default-properties>
  </cm:property-placeholder>

  <bean id="requestConfigBuilder" class="org.apache.http.client.config.RequestConfig"
    factory-method="custom">
    <property name="socketTimeout" value="${socketTimeoutMs}" />
    <property name="connectTimeout" value="${connectTimeoutMs}" />
  </bean>

  <bean id="requestConfig" factory-ref="requestConfigBuilder"
    factory-method="build" />

  <bean id="httpClientBuilder" class="org.apache.http.impl.client.HttpClientBuilder"
    factory-method="create">
    <property name="defaultRequestConfig" ref="requestConfig" />
  </bean>

  <bean id="httpClient" factory-ref="httpClientBuilder"
    factory-method="build" />

  <bean id="httpOntologyRegistry">
    <property name="httpClient" ref="httpClient" />
  </bean>

  <service id="ontologyRegistry" ref="httpOntologyRegistry" />
</blueprint>